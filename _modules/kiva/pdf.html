<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>kiva.pdf &mdash; enable 5.0.0 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../../_static/enthought.css" type="text/css" >
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" >
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '5.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        LINK_SUFFIX: '',
        SOURCELINK_SUFFIX: '.txt',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/copybutton.js"></script>
    <script type="text/javascript" src="../../_static/js/wrap_on_dot.js"></script>
    <link rel="shortcut icon" href="../../_static/img/favicon.ico">
    <link rel="index" title="Index" href="../../genindex.html" >
    <link rel="search" title="Search" href="../../search.html" >
    <link rel="top" title="enable 5.0.0 documentation" href="../../index.html" >
    <link rel="up" title="Module code" href="../index.html" > 
  </head>
  <body>
  <div class="container">
    <div class="header">
    </div>
  </div>

    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../../index.html">enable 5.0.0 documentation</a></li>
	
          <li class="active"><a href="../index.html" accesskey="U">Module code</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body" role="main">
            
  <h1>Source code for kiva.pdf</h1><div class="highlight"><pre>
<span></span><span class="c1"># (C) Copyright 2005-2021 Enthought, Inc., Austin, TX</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># This software is provided without warranty under the terms of the BSD</span>
<span class="c1"># license included in LICENSE.txt and may be redistributed only under</span>
<span class="c1"># the conditions described in the aforementioned license. The license</span>
<span class="c1"># is also available online at http://www.enthought.com/licenses/BSD.txt</span>
<span class="c1">#</span>
<span class="c1"># Thanks for using Enthought open source!</span>

<span class="sd">&quot;&quot;&quot; PDF implementation of the core2d drawing library</span>

<span class="sd">    :Author:      Eric Jones, Enthought, Inc., eric@enthought.com</span>
<span class="sd">    :Copyright:   Space Telescope Science Institute</span>
<span class="sd">    :License:     BSD Style</span>

<span class="sd">    The PDF implementation relies heavily on the ReportLab project.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># standard library imports</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">ndarray</span><span class="p">,</span> <span class="n">pi</span>

<span class="c1"># ReportLab PDF imports</span>
<span class="kn">import</span> <span class="nn">reportlab.pdfbase.pdfmetrics</span>
<span class="kn">import</span> <span class="nn">reportlab.pdfbase._fontdata</span>
<span class="kn">from</span> <span class="nn">reportlab.pdfgen</span> <span class="k">import</span> <span class="n">canvas</span>

<span class="c1"># local, relative Kiva imports</span>
<span class="kn">from</span> <span class="nn">.arc_conversion</span> <span class="k">import</span> <span class="n">arc_to_tangent_points</span>
<span class="kn">from</span> <span class="nn">.basecore2d</span> <span class="k">import</span> <span class="n">GraphicsContextBase</span>
<span class="kn">from</span> <span class="nn">.line_state</span> <span class="k">import</span> <span class="n">is_dashed</span>
<span class="kn">from</span> <span class="nn">.constants</span> <span class="k">import</span> <span class="n">FILL</span><span class="p">,</span> <span class="n">STROKE</span><span class="p">,</span> <span class="n">EOF_FILL</span>
<span class="kn">import</span> <span class="nn">kiva.constants</span> <span class="k">as</span> <span class="nn">constants</span>
<span class="kn">import</span> <span class="nn">kiva.affine</span> <span class="k">as</span> <span class="nn">affine</span>


<span class="n">cap_style</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">cap_style</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">CAP_ROUND</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">cap_style</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">CAP_SQUARE</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">cap_style</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">CAP_BUTT</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">join_style</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">join_style</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">JOIN_ROUND</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">join_style</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">JOIN_BEVEL</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">join_style</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">JOIN_MITER</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># stroke, fill, mode</span>
<span class="n">path_mode</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">path_mode</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">FILL_STROKE</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">canvas</span><span class="o">.</span><span class="n">FILL_NON_ZERO</span><span class="p">)</span>
<span class="n">path_mode</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">FILL</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">canvas</span><span class="o">.</span><span class="n">FILL_NON_ZERO</span><span class="p">)</span>
<span class="n">path_mode</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">EOF_FILL</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">canvas</span><span class="o">.</span><span class="n">FILL_EVEN_ODD</span><span class="p">)</span>
<span class="n">path_mode</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">STROKE</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">canvas</span><span class="o">.</span><span class="n">FILL_NON_ZERO</span><span class="p">)</span>
<span class="n">path_mode</span><span class="p">[</span><span class="n">constants</span><span class="o">.</span><span class="n">EOF_FILL_STROKE</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">canvas</span><span class="o">.</span><span class="n">FILL_EVEN_ODD</span><span class="p">)</span>


<span class="c1"># fixme: I believe this can be implemented but for now, it is not.</span>
<div class="viewcode-block" id="CompiledPath"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.CompiledPath">[docs]</a><span class="k">class</span> <span class="nc">CompiledPath</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="GraphicsContext"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext">[docs]</a><span class="k">class</span> <span class="nc">GraphicsContext</span><span class="p">(</span><span class="n">GraphicsContextBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simple wrapper around a PDF graphics context.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf_canvas</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">.image</span> <span class="k">import</span> <span class="n">GraphicsContext</span> <span class="k">as</span> <span class="n">GraphicsContextImage</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span> <span class="o">=</span> <span class="n">pdf_canvas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_xy</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="c1"># get an agg backend to assist in measuring text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_agg_gc</span> <span class="o">=</span> <span class="n">GraphicsContextImage</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GraphicsContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Coordinate Transform Matrix Manipulation</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.scale_ctm"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.scale_ctm">[docs]</a>    <span class="k">def</span> <span class="nf">scale_ctm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        scale_ctm(sx: float, sy: float) -&gt; None</span>

<span class="sd">        Sets the coordinate system scale to the given values, (sx, sy).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.translate_ctm"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.translate_ctm">[docs]</a>    <span class="k">def</span> <span class="nf">translate_ctm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        translate_ctm(tx: float, ty: float) -&gt; None</span>

<span class="sd">        Translates the coordinate syetem by the given value by (tx, ty)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.rotate_ctm"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.rotate_ctm">[docs]</a>    <span class="k">def</span> <span class="nf">rotate_ctm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        rotate_ctm(angle: float) -&gt; None</span>

<span class="sd">        Rotates the coordinate space by the given angle (in radians).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">angle</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.concat_ctm"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.concat_ctm">[docs]</a>    <span class="k">def</span> <span class="nf">concat_ctm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        concat_ctm(transform: affine_matrix)</span>

<span class="sd">        Concatenates the transform to current coordinate transform matrix.</span>
<span class="sd">        transform is an affine transformation matrix (see kiva.affine_matrix).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.get_ctm"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.get_ctm">[docs]</a>    <span class="k">def</span> <span class="nf">get_ctm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the current coordinate transform matrix.</span>

<span class="sd">            XXX: This should really return a 3x3 matrix (or maybe an affine</span>
<span class="sd">                 object?) like the other API&#39;s.  Needs thought.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">affine</span><span class="o">.</span><span class="n">affine_from_values</span><span class="p">(</span><span class="o">*</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">_currentMatrix</span><span class="p">))</span></div>

<div class="viewcode-block" id="GraphicsContext.set_ctm"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_ctm">[docs]</a>    <span class="k">def</span> <span class="nf">set_ctm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set the coordinate transform matrix</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># We have to do this by inverting the current state to zero it out,</span>
        <span class="c1"># then transform by desired transform, as Reportlab Canvas doesn&#39;t</span>
        <span class="c1"># provide a method to directly set the ctm.</span>
        <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ctm</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concat_ctm</span><span class="p">(</span><span class="n">affine</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">current</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concat_ctm</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Save/Restore graphics state.</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.save_state"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.save_state">[docs]</a>    <span class="k">def</span> <span class="nf">save_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Saves the current graphic&#39;s context state.</span>

<span class="sd">            Always pair this with a `restore_state()`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">saveState</span><span class="p">()</span></div>

<div class="viewcode-block" id="GraphicsContext.restore_state"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.restore_state">[docs]</a>    <span class="k">def</span> <span class="nf">restore_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Restores the previous graphics state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">restoreState</span><span class="p">()</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Manipulate graphics state attributes.</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.set_should_antialias"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_should_antialias">[docs]</a>    <span class="k">def</span> <span class="nf">set_should_antialias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sets/Unsets anti-aliasing for bitmap graphics context.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;antialias is not part of the PDF canvas.  Should it be?&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.set_line_width"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_line_width">[docs]</a>    <span class="k">def</span> <span class="nf">set_line_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sets the line width for drawing</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            width : float</span>
<span class="sd">                The new width for lines in user space units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">setLineWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.set_line_join"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_line_join">[docs]</a>    <span class="k">def</span> <span class="nf">set_line_join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sets style for joining lines in a drawing.</span>

<span class="sd">            style : join_style</span>
<span class="sd">                The line joining style.  The available</span>
<span class="sd">                styles are JOIN_ROUND, JOIN_BEVEL, JOIN_MITER.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sjoin</span> <span class="o">=</span> <span class="n">join_style</span><span class="p">[</span><span class="n">style</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Invalid line join style. See documentation for valid styles&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">setLineJoin</span><span class="p">(</span><span class="n">sjoin</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.set_miter_limit"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_miter_limit">[docs]</a>    <span class="k">def</span> <span class="nf">set_miter_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Specifies limits on line lengths for mitering line joins.</span>

<span class="sd">            If line_join is set to miter joins, the limit specifies which</span>
<span class="sd">            line joins should actually be mitered.  If lines aren&#39;t mitered,</span>
<span class="sd">            they are joined with a bevel.  The line width is divided by</span>
<span class="sd">            the length of the miter.  If the result is greater than the</span>
<span class="sd">            limit, the bevel style is used.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            limit : float</span>
<span class="sd">                limit for mitering joins.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">setMiterLimit</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.set_line_cap"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_line_cap">[docs]</a>    <span class="k">def</span> <span class="nf">set_line_cap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Specifies the style of endings to put on line ends.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            style : cap_style</span>
<span class="sd">                the line cap style to use. Available styles</span>
<span class="sd">                are CAP_ROUND, CAP_BUTT, CAP_SQUARE</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">scap</span> <span class="o">=</span> <span class="n">cap_style</span><span class="p">[</span><span class="n">style</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Invalid line cap style.  See documentation for valid styles&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">setLineCap</span><span class="p">(</span><span class="n">scap</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.set_line_dash"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_line_dash">[docs]</a>    <span class="k">def</span> <span class="nf">set_line_dash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lengths</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            lengths : float array</span>
<span class="sd">                An array of floating point values</span>
<span class="sd">                specifing the lengths of on/off painting</span>
<span class="sd">                pattern for lines.</span>
<span class="sd">            phase : float</span>
<span class="sd">                Specifies how many units into dash pattern</span>
<span class="sd">                to start.  phase defaults to 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_dashed</span><span class="p">((</span><span class="n">phase</span><span class="p">,</span> <span class="n">lengths</span><span class="p">)):</span>
            <span class="n">lengths</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span> <span class="k">if</span> <span class="n">lengths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">setDash</span><span class="p">(</span><span class="n">lengths</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.set_flatness"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_flatness">[docs]</a>    <span class="k">def</span> <span class="nf">set_flatness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flatness</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            It is device dependent and therefore not recommended by</span>
<span class="sd">            the PDF documentation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Flatness not implemented yet on PDF&quot;</span><span class="p">)</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Sending drawing data to a device</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.flush"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.flush">[docs]</a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sends all drawing data to the destination device.</span>

<span class="sd">            Currently, this is a NOP.  It used to call ReportLab&#39;s save()</span>
<span class="sd">            method, and maybe it still should, but flush() is likely to</span>
<span class="sd">            be called a lot, so this will really slow things down.  Also,</span>
<span class="sd">            I think save() affects the paging of a document I think.</span>
<span class="sd">            We&#39;ll have to look into this more.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="GraphicsContext.synchronize"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.synchronize">[docs]</a>    <span class="k">def</span> <span class="nf">synchronize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Prepares drawing data to be updated on a destination device.</span>

<span class="sd">            Currently, doesn&#39;t do anything.</span>
<span class="sd">            Should this call ReportLab&#39;s canvas object&#39;s showPage() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Page Definitions</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.begin_page"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.begin_page">[docs]</a>    <span class="k">def</span> <span class="nf">begin_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a new page within the graphics context.</span>

<span class="sd">            Currently, this just calls ReportLab&#39;s canvas object&#39;s</span>
<span class="sd">            showPage() method.  Not sure about this...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">showPage</span><span class="p">()</span></div>

<div class="viewcode-block" id="GraphicsContext.end_page"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.end_page">[docs]</a>    <span class="k">def</span> <span class="nf">end_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Ends drawing in the current page of the graphics context.</span>

<span class="sd">            Currently, this just calls ReportLab&#39;s canvas object&#39;s</span>
<span class="sd">            showPage() method.  Not sure about this...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">showPage</span><span class="p">()</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Building paths (contours that are drawn)</span>
    <span class="c1">#</span>
    <span class="c1"># + Currently, nothing is drawn as the path is built.  Instead, the</span>
    <span class="c1">#   instructions are stored and later drawn.  Should this be changed?</span>
    <span class="c1">#   We will likely draw to a buffer instead of directly to the canvas</span>
    <span class="c1">#   anyway.</span>
    <span class="c1">#</span>
    <span class="c1">#   Hmmm. No.  We have to keep the path around for storing as a</span>
    <span class="c1">#   clipping region and things like that.</span>
    <span class="c1">#</span>
    <span class="c1"># + I think we should keep the current_path_point hanging around.</span>
    <span class="c1">#</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.begin_path"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.begin_path">[docs]</a>    <span class="k">def</span> <span class="nf">begin_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clears the current drawing path and begins a new one.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">beginPath</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.move_to"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.move_to">[docs]</a>    <span class="k">def</span> <span class="nf">move_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Starts a new drawing subpath at place the current point at (x, y).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">begin_path</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.line_to"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.line_to">[docs]</a>    <span class="k">def</span> <span class="nf">line_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds a line from the current point to the given point (x, y).</span>

<span class="sd">            The current point is moved to (x, y).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">begin_path</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">lineTo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.lines"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.lines">[docs]</a>    <span class="k">def</span> <span class="nf">lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds a series of lines as a new subpath.</span>

<span class="sd">            Currently implemented by calling line_to a zillion times.</span>

<span class="sd">            Points is an Nx2 array of x, y pairs.</span>

<span class="sd">            current_point is moved to the last point in points</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">begin_path</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">lineTo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.line_set"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.line_set">[docs]</a>    <span class="k">def</span> <span class="nf">line_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starts</span><span class="p">,</span> <span class="n">ends</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">begin_path</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">starts</span><span class="p">,</span> <span class="n">ends</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">start</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">lineTo</span><span class="p">(</span><span class="n">end</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">end</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="GraphicsContext.rect"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.rect">[docs]</a>    <span class="k">def</span> <span class="nf">rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds a rectangle as a new subpath.  Can be called in two ways:</span>
<span class="sd">              rect(x, y, w, h)</span>
<span class="sd">              rect( (x, y, w, h) )</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">begin_path</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="GraphicsContext.draw_rect"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.draw_rect">[docs]</a>    <span class="k">def</span> <span class="nf">draw_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">FILL_STROKE</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_path</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">rect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rect</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="GraphicsContext.rects"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.rects">[docs]</a>    <span class="k">def</span> <span class="nf">rects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rects</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds multiple rectangles as separate subpaths to the path.</span>

<span class="sd">            Currently implemented by calling rect a zillion times.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">begin_path</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span> <span class="ow">in</span> <span class="n">rects</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.close_path"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.close_path">[docs]</a>    <span class="k">def</span> <span class="nf">close_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Closes the path of the current subpath.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="GraphicsContext.curve_to"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.curve_to">[docs]</a>    <span class="k">def</span> <span class="nf">curve_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cp1x</span><span class="p">,</span> <span class="n">cp1y</span><span class="p">,</span> <span class="n">cp2x</span><span class="p">,</span> <span class="n">cp2y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">begin_path</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">curveTo</span><span class="p">(</span><span class="n">cp1x</span><span class="p">,</span> <span class="n">cp1y</span><span class="p">,</span> <span class="n">cp2x</span><span class="p">,</span> <span class="n">cp2y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.quad_curve_to"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.quad_curve_to">[docs]</a>    <span class="k">def</span> <span class="nf">quad_curve_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cpx</span><span class="p">,</span> <span class="n">cpy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;quad curve to not implemented yet on PDF&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.arc"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.arc">[docs]</a>    <span class="k">def</span> <span class="nf">arc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">start_angle</span><span class="p">,</span> <span class="n">end_angle</span><span class="p">,</span> <span class="n">clockwise</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">begin_path</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span>
            <span class="n">x</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span>
            <span class="n">start_angle</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">pi</span><span class="p">,</span>
            <span class="p">(</span><span class="n">end_angle</span> <span class="o">-</span> <span class="n">start_angle</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">pi</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.arc_to"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.arc_to">[docs]</a>    <span class="k">def</span> <span class="nf">arc_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">begin_path</span><span class="p">()</span>

        <span class="c1"># Get the endpoints on the curve where it touches the line segments</span>
        <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">arc_to_tangent_points</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">radius</span>
        <span class="p">)</span>

        <span class="c1"># draw!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">lineTo</span><span class="p">(</span><span class="o">*</span><span class="n">t1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">curveTo</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="o">*</span><span class="n">t2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="o">.</span><span class="n">lineTo</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Getting infomration on paths</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.is_path_empty"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.is_path_empty">[docs]</a>    <span class="k">def</span> <span class="nf">is_path_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Tests to see whether the current drawing path is empty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;is_path_empty not implemented yet on PDF&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.get_path_current_point"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.get_path_current_point">[docs]</a>    <span class="k">def</span> <span class="nf">get_path_current_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the current point from the graphics context.</span>

<span class="sd">            Note: This should be a tuple or array.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_point</span></div>

<div class="viewcode-block" id="GraphicsContext.get_path_bounding_box"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.get_path_bounding_box">[docs]</a>    <span class="k">def</span> <span class="nf">get_path_bounding_box</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Should return a tuple or array instead of a strange object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;get_path_bounding_box not implemented yet on PDF&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Clipping path manipulation</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.clip"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.clip">[docs]</a>    <span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">_fillMode</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">FILL_NON_ZERO</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">clipPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.even_odd_clip"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.even_odd_clip">[docs]</a>    <span class="k">def</span> <span class="nf">even_odd_clip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">_fillMode</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">FILL_EVEN_ODD</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">clipPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.clip_to_rect"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.clip_to_rect">[docs]</a>    <span class="k">def</span> <span class="nf">clip_to_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clips context to the given rectangular region.</span>

<span class="sd">            Region should be a 4-tuple or a sequence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clip_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">beginPath</span><span class="p">()</span>
        <span class="n">clip_path</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">clipPath</span><span class="p">(</span><span class="n">clip_path</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.clip_to_rects"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.clip_to_rects">[docs]</a>    <span class="k">def</span> <span class="nf">clip_to_rects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;clip_to_rects not implemented yet on PDF.&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.clear_clip_path"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.clear_clip_path">[docs]</a>    <span class="k">def</span> <span class="nf">clear_clip_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clip_to_rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Color space manipulation</span>
    <span class="c1">#</span>
    <span class="c1"># I&#39;m not sure we&#39;ll mess with these at all.  They seem to</span>
    <span class="c1"># be for setting the color syetem.  Hard coding to RGB or</span>
    <span class="c1"># RGBA for now sounds like a reasonable solution.</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.set_fill_color_space"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_fill_color_space">[docs]</a>    <span class="k">def</span> <span class="nf">set_fill_color_space</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;set_fill_color_space not implemented on PDF yet.&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.set_stroke_color_space"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_stroke_color_space">[docs]</a>    <span class="k">def</span> <span class="nf">set_stroke_color_space</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;set_stroke_color_space not implemented on PDF yet.&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.set_rendering_intent"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_rendering_intent">[docs]</a>    <span class="k">def</span> <span class="nf">set_rendering_intent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;set_rendering_intent not implemented on PDF yet.&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Color manipulation</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.set_fill_color"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_fill_color">[docs]</a>    <span class="k">def</span> <span class="nf">set_fill_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">color</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">setFillColorRGB</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.set_stroke_color"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_stroke_color">[docs]</a>    <span class="k">def</span> <span class="nf">set_stroke_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">color</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">setStrokeColorRGB</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.set_alpha"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_alpha">[docs]</a>    <span class="k">def</span> <span class="nf">set_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sets alpha globally. Note that this will not affect draw_image</span>
<span class="sd">            because reportlab does not currently support drawing images with</span>
<span class="sd">            alpha.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">setFillAlpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">setStrokeAlpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GraphicsContext</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Drawing Images</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.draw_image"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.draw_image">[docs]</a>    <span class="k">def</span> <span class="nf">draw_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        draw_image(img_gc, rect=(x, y, w, h))</span>

<span class="sd">        Draws another gc into this one.  If &#39;rect&#39; is not provided, then</span>
<span class="sd">        the image gc is drawn into this one, rooted at (0, 0) and at full</span>
<span class="sd">        pixel size.  If &#39;rect&#39; is provided, then the image is resized</span>
<span class="sd">        into the (w, h) given and drawn into this GC at point (x, y).</span>

<span class="sd">        img_gc is either a Numeric array (WxHx3 or WxHx4) or a PIL Image.</span>

<span class="sd">        Requires the Python Imaging Library (PIL).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># We turn img into a PIL object, since that is what ReportLab</span>
        <span class="c1"># requires.  To do this, we first determine if the input image</span>
        <span class="c1"># GC needs to be converted to RGBA/RGB.  If so, we see if we can</span>
        <span class="c1"># do it nicely (using convert_pixel_format), and if not, we do</span>
        <span class="c1"># it brute-force using Agg.</span>
        <span class="kn">from</span> <span class="nn">reportlab.lib.utils</span> <span class="k">import</span> <span class="n">ImageReader</span>
        <span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">):</span>
            <span class="c1"># Conversion from numpy array</span>
            <span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span>
            <span class="n">pil_img</span> <span class="o">=</span> <span class="n">img</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="s2">&quot;bmp_array&quot;</span><span class="p">):</span>
            <span class="c1"># An offscreen kiva agg context</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="s2">&quot;convert_pixel_format&quot;</span><span class="p">):</span>
                <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">convert_pixel_format</span><span class="p">(</span><span class="s2">&quot;rgba32&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">pil_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">bmp_array</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Cannot render image of type </span><span class="si">%r</span><span class="s2"> into PDF context.&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">rect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rect</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pil_img</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pil_img</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>

        <span class="c1"># Draw the actual image.</span>
        <span class="c1"># Wrap it in an ImageReader object, because that&#39;s what reportlab</span>
        <span class="c1"># actually needs.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">drawImage</span><span class="p">(</span>
            <span class="n">ImageReader</span><span class="p">(</span><span class="n">pil_img</span><span class="p">),</span> <span class="n">rect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rect</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rect</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">rect</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="p">)</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Drawing Text</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.select_font"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.select_font">[docs]</a>    <span class="k">def</span> <span class="nf">select_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">textEncoding</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; PDF ignores the Encoding variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.set_font"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_font">[docs]</a>    <span class="k">def</span> <span class="nf">set_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sets the font for the current graphics context.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: Make this actually do the right thing</span>
        <span class="n">face_name</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">face_name</span>
        <span class="k">if</span> <span class="n">face_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">face_name</span> <span class="o">=</span> <span class="s2">&quot;Helvetica&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">face_name</span><span class="p">,</span> <span class="n">font</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.get_font"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.get_font">[docs]</a>    <span class="k">def</span> <span class="nf">get_font</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the current font &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="GraphicsContext.set_font_size"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_font_size">[docs]</a>    <span class="k">def</span> <span class="nf">set_font_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">_fontname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.set_character_spacing"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_character_spacing">[docs]</a>    <span class="k">def</span> <span class="nf">set_character_spacing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="GraphicsContext.get_character_spacing"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.get_character_spacing">[docs]</a>    <span class="k">def</span> <span class="nf">get_character_spacing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the current font &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="GraphicsContext.set_text_drawing_mode"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_text_drawing_mode">[docs]</a>    <span class="k">def</span> <span class="nf">set_text_drawing_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="GraphicsContext.set_text_position"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_text_position">[docs]</a>    <span class="k">def</span> <span class="nf">set_text_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_xy</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span></div>

<div class="viewcode-block" id="GraphicsContext.get_text_position"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.get_text_position">[docs]</a>    <span class="k">def</span> <span class="nf">get_text_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">text_matrix</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span></div>

<div class="viewcode-block" id="GraphicsContext.set_text_matrix"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.set_text_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">set_text_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ttm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">affine_params</span><span class="p">(</span><span class="n">ttm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">_textMatrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.get_text_matrix"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.get_text_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">get_text_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">_textMatrix</span>
        <span class="k">return</span> <span class="n">affine</span><span class="o">.</span><span class="n">affine_from_values</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.show_text"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.show_text">[docs]</a>    <span class="k">def</span> <span class="nf">show_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Draws text on the device at current text position.</span>

<span class="sd">            This is also used for showing text at a particular point</span>
<span class="sd">            specified by x and y.</span>

<span class="sd">            This ignores the text matrix for now.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">y</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">drawString</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.show_text_at_point"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.show_text_at_point">[docs]</a>    <span class="k">def</span> <span class="nf">show_text_at_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.show_glyphs"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.show_glyphs">[docs]</a>    <span class="k">def</span> <span class="nf">show_glyphs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;show_glyphs not implemented on PDF yet.&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.get_full_text_extent"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.get_full_text_extent">[docs]</a>    <span class="k">def</span> <span class="nf">get_full_text_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textstring</span><span class="p">):</span>
        <span class="n">fontname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">_fontname</span>
        <span class="n">fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">_fontsize</span>

        <span class="n">ascent</span><span class="p">,</span> <span class="n">descent</span> <span class="o">=</span> <span class="n">reportlab</span><span class="o">.</span><span class="n">pdfbase</span><span class="o">.</span><span class="n">_fontdata</span><span class="o">.</span><span class="n">ascent_descent</span><span class="p">[</span><span class="n">fontname</span><span class="p">]</span>

        <span class="c1"># get the AGG extent (we just care about the descent)</span>
        <span class="n">aw</span><span class="p">,</span> <span class="n">ah</span><span class="p">,</span> <span class="n">ad</span><span class="p">,</span> <span class="n">al</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agg_gc</span><span class="o">.</span><span class="n">get_full_text_extent</span><span class="p">(</span><span class="n">textstring</span><span class="p">)</span>

        <span class="c1"># ignore the descent returned by reportlab if AGG returned 0.0 descent</span>
        <span class="n">descent</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="n">ad</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="k">else</span> <span class="n">descent</span> <span class="o">*</span> <span class="n">fontsize</span> <span class="o">/</span> <span class="mf">1000.0</span>
        <span class="n">ascent</span> <span class="o">=</span> <span class="n">ascent</span> <span class="o">*</span> <span class="n">fontsize</span> <span class="o">/</span> <span class="mf">1000.0</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">ascent</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">descent</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">stringWidth</span><span class="p">(</span><span class="n">textstring</span><span class="p">,</span> <span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">)</span>

        <span class="c1"># the final return value is defined as leading. do not know</span>
        <span class="c1"># how to get that number so returning zero</span>
        <span class="k">return</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">descent</span><span class="p">,</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="GraphicsContext.get_text_extent"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.get_text_extent">[docs]</a>    <span class="k">def</span> <span class="nf">get_text_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textstring</span><span class="p">):</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_full_text_extent</span><span class="p">(</span><span class="n">textstring</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Painting paths (drawing and filling contours)</span>
    <span class="c1"># ----------------------------------------------------------------</span>

<div class="viewcode-block" id="GraphicsContext.clear"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;clear() is ignored for the pdf backend&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.stroke_path"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.stroke_path">[docs]</a>    <span class="k">def</span> <span class="nf">stroke_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_path</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">STROKE</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.fill_path"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.fill_path">[docs]</a>    <span class="k">def</span> <span class="nf">fill_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_path</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">FILL</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.eof_fill_path"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.eof_fill_path">[docs]</a>    <span class="k">def</span> <span class="nf">eof_fill_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_path</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">EOF_FILL</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.stroke_rect"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.stroke_rect">[docs]</a>    <span class="k">def</span> <span class="nf">stroke_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">begin_path</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">rect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rect</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rect</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">rect</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stroke_path</span><span class="p">()</span></div>

<div class="viewcode-block" id="GraphicsContext.stroke_rect_with_width"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.stroke_rect_with_width">[docs]</a>    <span class="k">def</span> <span class="nf">stroke_rect_with_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;stroke_rect_with_width not implemented on PDF yet.&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.fill_rect"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.fill_rect">[docs]</a>    <span class="k">def</span> <span class="nf">fill_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">begin_path</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">rect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rect</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rect</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">rect</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_path</span><span class="p">()</span></div>

<div class="viewcode-block" id="GraphicsContext.fill_rects"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.fill_rects">[docs]</a>    <span class="k">def</span> <span class="nf">fill_rects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;fill_rects not implemented on PDF yet.&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.clear_rect"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.clear_rect">[docs]</a>    <span class="k">def</span> <span class="nf">clear_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;clear_rect not implemented on PDF yet.&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="GraphicsContext.draw_path"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.draw_path">[docs]</a>    <span class="k">def</span> <span class="nf">draw_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">FILL_STROKE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Walks through all the drawing subpaths and draw each element.</span>

<span class="sd">            Each subpath is drawn separately.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stroke</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">path_mode</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">_fillMode</span> <span class="o">=</span> <span class="n">mode</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">drawPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="n">stroke</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">)</span>
            <span class="c1"># erase the current path.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_pdf_path</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="GraphicsContext.save"><a class="viewcode-back" href="../../api/kiva.pdf.html#kiva.pdf.GraphicsContext.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div></div>
</pre></div>

          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/img/e-logo.png" alt="Logo">
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2005-2021, Enthought
      </li>
      <li>
      Last updated on Feb 23, 2021.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.3.1.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>