<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>Enable Toolkit Selection &mdash; enable 5.2.0 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/enthought.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        LINK_SUFFIX: '',
        SOURCELINK_SUFFIX: '.txt',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <script type="text/javascript" src="../_static/js/wrap_on_dot.js"></script>
    <link rel="shortcut icon" href="../_static/img/favicon.ico">
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="enable 5.2.0 documentation" href="../index.html" >
    <link rel="next" title="Testing Enable Components" href="testing.html" >
    <link rel="prev" title="Enable Custom Traits" href="traits.html" > 
  </head>
  <body>
  <div class="container">
    <div class="header">
    </div>
  </div>

    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">enable 5.2.0 documentation</a></li>
	 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="testing.html" title="Testing Enable Components"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="traits.html" title="Enable Custom Traits"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body" role="main">
            
  <div class="section" id="enable-toolkit-selection">
<span id="toolkit-selection"></span><h1>Enable Toolkit Selection<a class="headerlink" href="#enable-toolkit-selection" title="Permalink to this headline">¶</a></h1>
<p>One of the more complicated aspects of Enable is the way in which it selects
which widget toolkit (Qt, Wx, etc.) to use when constructing a <code class="xref py py-class docutils literal notranslate"><span class="pre">Window</span></code>
instance. Further, there is also a second choice of which kiva
<code class="xref py py-class docutils literal notranslate"><span class="pre">GraphicsContext</span></code> implementation to use along with the selected widget
toolkit.</p>
<p>There are of course defaults for both toolkit and kiva backend, which might even
depend on the packages available in the Python environment where code is
running. For most users, these defaults are sufficient and stable over time. For
users that have specific needs, the widget toolkit and kiva backend can be
explicitly specified.</p>
<div class="section" id="etsconfig">
<h2>ETSConfig<a class="headerlink" href="#etsconfig" title="Permalink to this headline">¶</a></h2>
<p>To control toolkit selection directly from application code, one must use
<code class="xref py py-class docutils literal notranslate"><span class="pre">ETSConfig</span></code>. Specifically, the
<code class="docutils literal notranslate"><span class="pre">ETSConfig.toolkit</span></code> trait should be set.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">ETSConfig.toolkit</span></code> must be set before importing Enable code, directly or
indirectly (via Chaco).</p>
</div>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">traits.etsconfig.api</span> <span class="kn">import</span> <span class="n">ETSConfig</span>

<span class="n">ETSConfig</span><span class="o">.</span><span class="n">toolkit</span> <span class="o">=</span> <span class="s1">&#39;qt&#39;</span>
<span class="kn">from</span> <span class="nn">chaco.api</span> <span class="kn">import</span> <span class="n">Plot</span>
<span class="kn">from</span> <span class="nn">enable.api</span> <span class="kn">import</span> <span class="n">ComponentEditor</span>

<span class="c1"># ...</span>
</pre></div>
</div>
<p>For the example, the application would use the Qt toolkit and the default kiva
backend [currently <code class="docutils literal notranslate"><span class="pre">image</span></code>].</p>
<p>The format of the <code class="docutils literal notranslate"><span class="pre">ETSConfig.toolkit</span></code> property is
<code class="docutils literal notranslate"><span class="pre">&lt;widget</span> <span class="pre">toolkit&gt;[.&lt;kiva</span> <span class="pre">backend&gt;]</span></code>. The <code class="docutils literal notranslate"><span class="pre">.&lt;kiva</span> <span class="pre">backend&gt;</span></code> part is
<em>optional</em>. If no value is given for <code class="docutils literal notranslate"><span class="pre">&lt;kiva</span> <span class="pre">backend&gt;</span></code>, the default kiva
backend is then selected by <code class="docutils literal notranslate"><span class="pre">ESTConfig</span></code>. That means that if you want to use
the <code class="docutils literal notranslate"><span class="pre">QPainter</span></code> backend in your Qt-based application, you should do this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">traits.etsconfig.api</span> <span class="kn">import</span> <span class="n">ETSConfig</span>
<span class="n">ETSConfig</span><span class="o">.</span><span class="n">toolkit</span> <span class="o">=</span> <span class="s1">&#39;qt.qpainter&#39;</span>
</pre></div>
</div>
<p>As another example, you might have a headless program (like a web server) which
wants to generate plots with Chaco. So you could use the <code class="docutils literal notranslate"><span class="pre">null</span></code> toolkit and
<code class="docutils literal notranslate"><span class="pre">image</span></code> backend:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">traits.etsconfig.api</span> <span class="kn">import</span> <span class="n">ETSConfig</span>
<span class="n">ETSConfig</span><span class="o">.</span><span class="n">toolkit</span> <span class="o">=</span> <span class="s1">&#39;null.image&#39;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ETSConfig</span></code> has a read-only property <code class="docutils literal notranslate"><span class="pre">kiva_backend</span></code> which you can read if
you’d like to know which kiva backend is currently selected, in case you haven’t
explicitly selected a backend.</p>
</div>
<div class="section" id="ets-toolkit">
<h2>ETS_TOOLKIT<a class="headerlink" href="#ets-toolkit" title="Permalink to this headline">¶</a></h2>
<p>If you wish to test toolkit/backend combinations <em>without</em> the need for code
modifications, you can set the <code class="docutils literal notranslate"><span class="pre">ETS_TOOLKIT</span></code> environment variable before
running your application. <code class="docutils literal notranslate"><span class="pre">ETSConfig</span></code> will use the value of that environment
variable to initialize its <code class="docutils literal notranslate"><span class="pre">toolkit</span></code> and <code class="docutils literal notranslate"><span class="pre">kiva_backend</span></code> properties. Here’s
what that looks like:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">export</span> <span class="nv">ETS_TOOLKIT</span><span class="o">=</span>qt.qpainter
$ python kiva/examples/kiva/kiva_explorer.py
</pre></div>
</div>
</div>
<div class="section" id="enable-toolkits-entrypoints">
<h2>enable.toolkits entrypoints<a class="headerlink" href="#enable-toolkits-entrypoints" title="Permalink to this headline">¶</a></h2>
<p>The allowed values for <code class="docutils literal notranslate"><span class="pre">ETSConfig.toolkit</span></code> are determined by the
<code class="docutils literal notranslate"><span class="pre">enable.toolkits</span></code> <a class="reference external" href="https://setuptools.readthedocs.io/en/latest/pkg_resources.html#entry-points">entrypoint</a>. An <code class="docutils literal notranslate"><span class="pre">enable.toolkits</span></code> entrypoint is a
<a class="reference external" href="https://docs.enthought.com/pyface/api/pyface.base_toolkit.html#pyface.base_toolkit.Toolkit" title="(in pyface v7.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Toolkit</span></code></a> object which when called with the name
of a class returns the appropriate version for the selected widget toolkit and
kiva backend.</p>
<p>The objects which are supplied by a toolkit/backend implementation are:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">CompiledPath</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphicsContext</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Window</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NativeScrollBar</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">font_metrics_provider()</span></code></p></li>
</ul>
<p>Because this is done via the setuptools entrypoint mechanism, it means that code
outside of Enable can contribute a custom toolkit and backends. To create a new
toolkit, you need to do the following:</p>
<ol class="arabic simple">
<li><p>Create a package for the toolkit</p></li>
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">toolkit.py</span></code> module (its name is just a convention) which should
contain a <a class="reference external" href="https://docs.enthought.com/pyface/api/pyface.base_toolkit.html#pyface.base_toolkit.Toolkit" title="(in pyface v7.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Toolkit</span></code></a> object initialized with the
details of your package.</p></li>
<li><p>Add an <code class="docutils literal notranslate"><span class="pre">enable.toolkits</span></code> list to the <code class="docutils literal notranslate"><span class="pre">entry_points</span></code> keyword argument of
your package’s <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> script’s call to the <code class="docutils literal notranslate"><span class="pre">setup()</span></code> function. This
list should contain a string with the format:
<code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span> <span class="pre">=</span> <span class="pre">my.package.toolkit:&lt;Toolkit</span> <span class="pre">object</span> <span class="pre">name&gt;</span></code>. This points to the
<code class="docutils literal notranslate"><span class="pre">Toolkit</span></code> object created in the previous step.</p></li>
<li><p>For every kiva backend supported by your toolkit, add a <code class="docutils literal notranslate"><span class="pre">&lt;backend&gt;.py</span></code>
module to the package. This module must contain the objects listed above
(<code class="docutils literal notranslate"><span class="pre">CompiledPath</span></code>, <code class="docutils literal notranslate"><span class="pre">GraphicsContext</span></code>, etc.)</p></li>
</ol>
<p>There’s one more wrinkle to consider. <a class="reference external" href="https://docs.enthought.com/pyface/api/pyface.base_toolkit.html#pyface.base_toolkit.Toolkit" title="(in pyface v7.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Toolkit</span></code></a>
normally expects to be called with a <code class="docutils literal notranslate"><span class="pre">&lt;module&gt;:&lt;class&gt;</span></code> format string, but
Enable’s usage of the <code class="docutils literal notranslate"><span class="pre">Toolkit</span></code> instance only passes a <code class="docutils literal notranslate"><span class="pre">&lt;class&gt;</span></code> name when
resolving objects. This is because <code class="docutils literal notranslate"><span class="pre">&lt;module&gt;</span></code> denotes the kiva backend, which
is not known until runtime. To provide this flexibility, the following wrapper
is used in Enable’s built-in toolkits:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_wrapper</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapped</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="c1"># Prefix object lookups with the name of the configured kiva backend.</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ETSConfig</span><span class="o">.</span><span class="n">kiva_backend</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapped</span>

<span class="n">toolkit</span> <span class="o">=</span> <span class="n">_wrapper</span><span class="p">(</span><span class="n">Toolkit</span><span class="p">(</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="s2">&quot;enable.null&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/img/e-logo.png" alt="Logo">
            </a></p>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Enable Toolkit Selection</a><ul>
<li><a class="reference internal" href="#etsconfig">ETSConfig</a></li>
<li><a class="reference internal" href="#ets-toolkit">ETS_TOOLKIT</a></li>
<li><a class="reference internal" href="#enable-toolkits-entrypoints">enable.toolkits entrypoints</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="traits.html"
                        title="previous chapter">Enable Custom Traits</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="testing.html"
                        title="next chapter">Testing Enable Components</a></p>
  <h3>This Page</h3>
  <div>
    <a href="../_sources/enable/toolkit_selection.rst.txt"
       rel="nofollow">Show Source</a>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2005-2021, Enthought
      </li>
      <li>
      Last updated on Jun 15, 2021.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.3.1.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>